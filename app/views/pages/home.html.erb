<% if user_signed_in? %>
  <h1 style="text-align:center; font-family:sans-serif;">
    Bienvenue <%= current_user.username %>
  </h1>

  <!-- ðŸ—“ï¸ SÃ©lecteur de pÃ©riode -->
  <div style="margin:20px auto; text-align:center;">
    <%= form_with url: root_path, method: :get, local: true, style: "display:inline-block;" do |f| %>
      <label for="start_date">DÃ©but :</label>
      <%= date_field_tag :start_date, @start_date, style: "margin-right:10px;" %>

      <label for="end_date">Fin :</label>
      <%= date_field_tag :end_date, @end_date, style: "margin-right:10px;" %>

      <%= submit_tag "Filtrer", class: "btn btn-info" %>
    <% end %>
  </div>

  <!-- ðŸ“Š Graphique -->
  <canvas id="financesChart"
    data-controller="simple-chart"
    data-simple-chart-chart-id-value="financesChart"
    data-simple-chart-available-value="<%= @available_balance || 0 %>"
    data-simple-chart-expenses-value="<%= @total_expenses || 0 %>"
    data-simple-chart-savings-value="<%= @savings || 0 %>">
  </canvas>


  <!-- ðŸ’° Totaux -->
  <div style="text-align:center; margin-top: 20px;">
    <p style="color:#2ecc71;">TrÃ©sorerie : <strong><%= number_to_currency(@total_revenues || 0) %></strong></p>
    <p style="color:#e74c3c;">Total dÃ©penses : <strong><%= number_to_currency(@total_expenses || 0) %></strong></p>
    <p style="color:#27ae60;">Ã‰pargne (objectifs) : <strong><%= number_to_currency(@savings || 0) %></strong></p>
    <hr style="width:60%; margin:10px auto;">
    <p style="color:#3498db;">ðŸ’¼ Solde disponible : <strong><%= number_to_currency(@available_balance || 0) %></strong></p>
  </div>

  <!-- ðŸ”— Boutons dâ€™accÃ¨s -->
  <div style="text-align:center; margin-top: 30px;">
    <%= link_to "Voir mes dÃ©penses", expenses_path, class: "btn btn-danger", style: "margin-right: 10px;" %>
    <%= link_to "Voir ma trÃ©sorerie", revenues_path, class: "btn btn-success", style: "margin-right: 10px;" %>
    <%= link_to "Mes Objectifs", goals_path, class: "btn btn-info" %>
  </div>

<% else %>
  <p style="text-align:center;">Pour voir vos finances, connectez-vous.</p>
  <div style="text-align:center; margin-top:10px;">
    <%= link_to "Se connecter", new_user_session_path, class:"btn btn-primary" %>
    <%= link_to "S'inscrire", new_user_registration_path, class:"btn btn-success" %>
  </div>
<% end %>
